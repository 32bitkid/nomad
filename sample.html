<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8" />
	<title></title>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js"></script>
	<script src="http://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
	<script>
		$(function () {
			$.get("http://nomad-api.herokuapp.com/trails", onTrails, 'json')

			function onTrails(trails, status) {
				var trail = trails[0]
				$('#name').text(trail.name)
				$('#description').text(trail.description)

				var first = trail.path.coordinates[0], last = trail.path.coordinates[trail.path.coordinates.length-1]
				var bounds = new google.maps.LatLngBounds(
					new google.maps.LatLng(
						Math.min(first[0], last[0]),
						Math.min(first[1], last[1])
					),
					new google.maps.LatLng(
						Math.max(first[0], last[0]),
						Math.max(first[1], last[1])
					)
				)
				var center = new google.maps.LatLng(
					0.5 * (first[0] + last[0]),
					0.5 * (first[1] + last[1])
				)
				var options = {
					zoom: 4,
					center: center,
					mapTypeId: google.maps.MapTypeId.TERRAIN
				}
				var canvas = $('#map-canvas')
				var map = new google.maps.Map(canvas.get(0), options)
				map.fitBounds(bounds)

				var polyline = {
					path: [],
					strokeColor: '#FF0000',
					strokeOpacity: 1.0,
					strokeWeight: 2
				}
				$.each(trail.path.coordinates, function (index, coord) {
					polyline.path.push(new google.maps.LatLng(coord[0], coord[1]))
				})
				new google.maps.Polyline(polyline).setMap(map)
			}
		})
	</script>
	<style>
		#map-canvas {
			height: 650px;
		}
	</style>
</head>
<body>
	<h1 id=name></h1>
	<div id=description></div>
	<div id="map-canvas"></div>
</body>
</html>